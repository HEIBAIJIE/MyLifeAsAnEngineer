# 《My Life As An Engineer》CSV数据框架说明

## 概述

本项目的CSV文件框架基于策划案设计，实现了一个完全数据驱动的生活模拟游戏系统。所有游戏内容都通过CSV配置，支持热更新和快速迭代。

## 文件结构

### 1. events.csv - 事件系统
定义所有玩家可主动触发的事件，包括：
- 事件ID、名称、时间消耗、场景要求、职级要求
- 触发条件（使用标准化条件表达式）
- 资源变化（疲劳、健康、饥饿、理性、感性、专注力、心情等）
- 技能变化、老板不满度、职级、项目进度、金钱变化
- 社交关系变化（同事好感度、技能等）
- 社交影响力、技术声誉、哲学感悟变化
- 物品获得和永久效果变化
- 返回文本ID

### 2. items.csv - 物品系统
定义所有游戏物品，包括：
- 物品ID、名称、类型、价格、存储位置
- 使用效果（疲劳、健康、饥饿、理性、感性、专注力、心情、技能变化）
- 永久效果类型和数值
- 书籍数量变化
- 物品描述（中英双语）

### 3. entities.csv - 实体交互系统
定义场景中的可交互实体：
- 人物实体（老板、同事）
- 设施实体（电脑、手机、床等）
- 每个实体的可用事件列表
- 交互条件要求

### 4. temporary_events.csv - 临时事件系统
定义基于状态自动触发的事件：
- 疲劳、健康、饥饿相关警告
- 职级晋升事件
- 项目完成和失败事件
- 结局触发条件

### 5. scheduled_tasks.csv - 定时任务系统
定义周期性触发的任务：
- 发薪水、交房租等生活节奏
- 同事协作的持续任务
- 技能衰退、社交需求等机制
- 永久效果的定期触发

### 6. resources.csv - 资源系统
定义所有游戏资源：
- 基础属性（时间、金钱、健康、疲劳、饥饿等）
- 理性与感性双重属性系统
- 专注力、心情、专业技能、老板不满度、职级、项目进度
- 物品栏系统（5格物品栏，每格包含物品ID和数量）
- 存储系统（冰箱9格、柜子9格，用于存放不同类型物品）
- 社交关系数据（3个同事的好感度和技能水平）
- 成就系统（累计完成项目数量等）
- 影响力系统（社交影响力、技术声誉、哲学感悟）
- 永久效果标记位（机械键盘、鼠标垫、空气净化器等）
- 系统数据（随机事件种子、当前场景等）

### 7. locations.csv - 场景系统
定义游戏中的6个场景：
- 公司、商店、家、公园、餐馆、医院
- 场景切换事件
- 每个场景的可用实体

### 8. game_texts/ - 文本系统
存储所有游戏反馈文本，采用分片存储：
- 按ID范围分割为多个CSV文件（如game_texts1~20.csv）
- 包含文本ID、中文内容、英文内容
- 事件结果描述、哲学思考内容、警告和提示信息
- 支持中英双语和文本的分类管理

### 9. endings.csv - 结局系统
定义所有可能的游戏结局：
- 失败结局（过劳死、被解雇等）
- 成就结局（技术专家、人生智者等）
- 平衡结局（工程师的平衡人生）
- 每个结局的哲学寓意

### 10. condition_parser_spec.md - 条件解析规范
定义标准化的条件表达式格式：
- 资源引用语法（resource[id]）
- 时间条件格式（time[property]）
- 计算表达式规则（calc[]、conditional[]）
- 安全性保障机制

## 设计特色

### 1. 数据驱动
- 所有游戏逻辑通过CSV配置
- 新增内容无需修改代码
- 支持快速平衡性调整

### 2. 哲学思考
- 理性vs感性的双重路径设计
- 工作与生活的平衡探索
- 每个事件都蕴含人生思考
- 专门的哲学感悟系统

### 3. 真实模拟
- 基于真实工程师生活设计
- 48个时间单元的日常节奏
- 工作日和周末的区分机制
- 详细的职级晋升系统（1-10级）

### 4. 系统完整性
- 临时事件提供状态反馈
- 定时任务营造生活节奏
- 永久效果系统支持长期规划
- 多种结局路径鼓励重复游玩
- 完整的社交关系系统

## 技术架构支持

### 1. 序列化存档
- 所有资源状态可完整保存
- 支持BASE64编码的存档系统
- 时间、金钱、属性的精确记录
- 物品栏和存储空间的完整状态

### 2. 事件计算公式
- 理性影响技术事件的专注力消耗
- 感性影响社交事件的效率
- 永久效果的百分比加成计算
- 职级和技能的成长曲线
- 复杂的条件判断和数学计算

### 3. 随机性控制
- 基于种子的伪随机系统
- 保证存档一致性
- 临时事件的触发概率
- 随机物品获得机制

### 4. 条件解析系统
- 标准化的条件表达式语法
- 安全的数学计算引擎
- 完整的错误处理机制
- 支持复杂的逻辑判断

## 条件表达式标准化

为了确保自动化判断的准确性，所有CSV文件中的触发条件都已标准化：

### 1. 资源引用
```
resource[14]>50    # 疲劳度大于50
resource[22]==1    # 职级等于1
```

### 2. 时间条件
```
time[day_of_week]==7&time[hour]==24    # 周日24点
time[workday]==true&time[hour]==9      # 工作日9点
time[weekend]==true                    # 周末时间
```

### 3. 计算表达式
```
calc[8000+2000*resource[22]]                    # 项目奖金计算
conditional[resource[2]>=2800?0:-2800]          # 条件判断
calc[floor(5*(1+resource[70]/50))]              # 向下取整计算
```

### 4. 安全性保障
- 所有数学运算都有除零检查
- 资源ID引用都经过验证
- 表达式复杂度有限制
- 支持完整的错误处理

## 实际数据规模

当前CSV系统包含的实际数据：
- **events.csv**: 190个事件，涵盖工作、社交、生活各个方面
- **items.csv**: 21种物品，包括食品和工具两大类
- **resources.csv**: 82种资源，完整的游戏状态管理
- **game_texts/**: 分片存储的文本系统，支持大量游戏文本
- **其他文件**: 完整的场景、实体、任务、结局配置

## 扩展性

该框架设计具有良好的扩展性：
- 新增事件只需添加CSV行
- 预留了永久效果扩展位（resources.csv中的79-82号资源）
- 文本系统支持本地化（中英双语）
- 结局系统可灵活扩展
- 条件解析器支持新语法
- 物品系统支持新类型和效果

## 自动化判断能力

经过标准化改进，当前的CSV系统已经具备了完全自动化判断的能力：

1. **条件表达准确性** - 所有条件都使用标准格式，程序可以准确解析
2. **数学计算安全性** - 所有计算都有安全检查，防止运行时错误
3. **资源引用一致性** - 使用统一的resource[id]格式，确保引用正确
4. **时间逻辑完整性** - 标准化的时间条件格式，支持复杂的时间判断
5. **错误处理完备性** - 完整的错误处理机制，确保系统稳定运行

通过这个CSV框架和条件解析规范，《My Life As An Engineer》实现了一个完整的、可配置的、支持自动化判断的生活模拟游戏系统。 